{
    "sourceFile": "src/main/java/com/mygg/render/GameCanvas.java",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 6,
            "patches": [
                {
                    "date": 1764385514385,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764388881242,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,15 +11,27 @@\n public class GameCanvas extends Canvas {\r\n \r\n     private final Player player;\r\n     private final InputHandler input;\r\n+\r\n+    // Map tiles (32x32)\r\n+    private final int tileSize = 32;\r\n+    private int[][] map;\r\n+\r\n+    private Image tileUnbreak;\r\n+    private Image tileBreak;\r\n+    private Image tileGround;\r\n+\r\n     private long last = System.nanoTime();\r\n \r\n     public GameCanvas(Player player, InputHandler input) {\r\n         super(800, 600);\r\n         this.player = player;\r\n         this.input = input;\r\n \r\n+        loadTiles();\r\n+        generateMap(25, 19); // ukuran default map 25 x 19\r\n+\r\n         new AnimationTimer() {\r\n             @Override\r\n             public void handle(long now) {\r\n                 double dt = (now - last) / 1e9;\r\n@@ -30,8 +42,45 @@\n             }\r\n         }.start();\r\n     }\r\n \r\n+    private void loadTiles() {\r\n+        tileUnbreak = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/unbreak.png\"));\r\n+        tileBreak   = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/break.png\"));\r\n+        tileGround  = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/ground.png\"));\r\n+    }\r\n+\r\n+    private void generateMap(int w, int h) {\r\n+\r\n+        map = new int[h][w];\r\n+\r\n+        for (int y = 0; y < h; y++) {\r\n+            for (int x = 0; x < w; x++) {\r\n+\r\n+                // border selalu unbreakable\r\n+                if (x == 0 || y == 0 || x == w - 1 || y == h - 1) {\r\n+                    map[y][x] = 1;\r\n+                    continue;\r\n+                }\r\n+\r\n+                // pola tembok unbreakable (seperti Bomberman klasik)\r\n+                if (x % 2 == 0 && y % 2 == 0) {\r\n+                    map[y][x] = 1;\r\n+                    continue;\r\n+                }\r\n+\r\n+                // random breakable\r\n+                if (Math.random() < 0.35) {\r\n+                    map[y][x] = 2;\r\n+                    continue;\r\n+                }\r\n+\r\n+                // ground biasa\r\n+                map[y][x] = 0;\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n     private void update(double dt) {\r\n \r\n         boolean move = false;\r\n \r\n@@ -64,12 +113,35 @@\n     }\r\n \r\n     private void draw() {\r\n         GraphicsContext g = getGraphicsContext2D();\r\n-\r\n         g.clearRect(0, 0, getWidth(), getHeight());\r\n \r\n+        drawMap(g);\r\n+\r\n         Image frame = player.update(1 / 60.0);\r\n-\r\n         g.drawImage(frame, player.x, player.y);\r\n     }\r\n+\r\n+    private void drawMap(GraphicsContext g) {\r\n+        if (map == null) return;\r\n+\r\n+        for (int y = 0; y < map.length; y++) {\r\n+            for (int x = 0; x < map[0].length; x++) {\r\n+\r\n+                int type = map[y][x];\r\n+                Image t = switch (type) {\r\n+                    case 1 -> tileUnbreak;\r\n+                    case 2 -> tileBreak;\r\n+                    default -> tileGround;\r\n+                };\r\n+\r\n+                g.drawImage(t,\r\n+                    x * tileSize,\r\n+                    y * tileSize,\r\n+                    tileSize,\r\n+                    tileSize\r\n+                );\r\n+            }\r\n+        }\r\n+    }\r\n }\r\n"
                },
                {
                    "date": 1764394319172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n package com.mygg.render;\r\n \r\n import com.mygg.core.InputHandler;\r\n import com.mygg.entities.Player;\r\n+import com.mygg.map.MapGenerator;\r\n \r\n import javafx.animation.AnimationTimer;\r\n import javafx.scene.canvas.Canvas;\r\n import javafx.scene.canvas.GraphicsContext;\r\n@@ -12,136 +13,118 @@\n \r\n     private final Player player;\r\n     private final InputHandler input;\r\n \r\n-    // Map tiles (32x32)\r\n-    private final int tileSize = 32;\r\n-    private int[][] map;\r\n+    private final int[][] map;\r\n \r\n-    private Image tileUnbreak;\r\n-    private Image tileBreak;\r\n-    private Image tileGround;\r\n+    private final Image ground;\r\n+    private final Image breakable;\r\n+    private final Image unbreak;\r\n \r\n-    private long last = System.nanoTime();\r\n+    private final int tile = 32;\r\n \r\n     public GameCanvas(Player player, InputHandler input) {\r\n         super(800, 600);\r\n+\r\n         this.player = player;\r\n         this.input = input;\r\n \r\n-        loadTiles();\r\n-        generateMap(25, 19); // ukuran default map 25 x 19\r\n+        // Load map 13x13\r\n+        this.map = MapGenerator.generate(13, 13);\r\n \r\n-        new AnimationTimer() {\r\n-            @Override\r\n-            public void handle(long now) {\r\n-                double dt = (now - last) / 1e9;\r\n-                last = now;\r\n+        // Load textures\r\n+        ground = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/ground.png\"), 32, 32, false, false);\r\n+        breakable = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/break.png\"), 32, 32, false, false);\r\n+        unbreak = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/unbreak.png\"), 32, 32, false, false);\r\n \r\n-                update(dt);\r\n-                draw();\r\n-            }\r\n-        }.start();\r\n-    }\r\n+        player.x = tile * 1;\r\n+        player.y = tile * 1;\r\n \r\n-    private void loadTiles() {\r\n-        tileUnbreak = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/unbreak.png\"));\r\n-        tileBreak   = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/break.png\"));\r\n-        tileGround  = new Image(getClass().getResourceAsStream(\"/com/mygg/assets/tiles/ground.png\"));\r\n+        loop.start();\r\n     }\r\n \r\n-    private void generateMap(int w, int h) {\r\n+    private final AnimationTimer loop = new AnimationTimer() {\r\n+        long last = System.nanoTime();\r\n \r\n-        map = new int[h][w];\r\n+        @Override\r\n+        public void handle(long now) {\r\n+            double dt = (now - last) / 1e9;\r\n+            last = now;\r\n \r\n-        for (int y = 0; y < h; y++) {\r\n-            for (int x = 0; x < w; x++) {\r\n-\r\n-                // border selalu unbreakable\r\n-                if (x == 0 || y == 0 || x == w - 1 || y == h - 1) {\r\n-                    map[y][x] = 1;\r\n-                    continue;\r\n-                }\r\n-\r\n-                // pola tembok unbreakable (seperti Bomberman klasik)\r\n-                if (x % 2 == 0 && y % 2 == 0) {\r\n-                    map[y][x] = 1;\r\n-                    continue;\r\n-                }\r\n-\r\n-                // random breakable\r\n-                if (Math.random() < 0.35) {\r\n-                    map[y][x] = 2;\r\n-                    continue;\r\n-                }\r\n-\r\n-                // ground biasa\r\n-                map[y][x] = 0;\r\n-            }\r\n+            update(dt);\r\n+            render();\r\n         }\r\n-    }\r\n+    };\r\n \r\n     private void update(double dt) {\r\n \r\n-        boolean move = false;\r\n+        double speed = player.speed * dt;\r\n \r\n+        double nextX = player.x;\r\n+        double nextY = player.y;\r\n+\r\n         if (input.up) {\r\n-            player.y -= player.speed * dt;\r\n+            nextY -= speed;\r\n             player.dir = Player.Direction.UP;\r\n-            move = true;\r\n         }\r\n         if (input.down) {\r\n-            player.y += player.speed * dt;\r\n+            nextY += speed;\r\n             player.dir = Player.Direction.DOWN;\r\n-            move = true;\r\n         }\r\n         if (input.left) {\r\n-            player.x -= player.speed * dt;\r\n+            nextX -= speed;\r\n             player.dir = Player.Direction.LEFT;\r\n-            move = true;\r\n         }\r\n         if (input.right) {\r\n-            player.x += player.speed * dt;\r\n+            nextX += speed;\r\n             player.dir = Player.Direction.RIGHT;\r\n-            move = true;\r\n         }\r\n \r\n-        if (input.place) {\r\n-            player.state = Player.State.PLACE;\r\n-        } else {\r\n-            player.state = move ? Player.State.WALK : Player.State.IDLE;\r\n+        // Collision check\r\n+        if (!collides(nextX, player.y)) {\r\n+            player.x = nextX;\r\n         }\r\n+        if (!collides(player.x, nextY)) {\r\n+            player.y = nextY;\r\n+        }\r\n+\r\n+        // animation state\r\n+        player.state = (input.up || input.down || input.left || input.right)\r\n+                ? Player.State.WALK\r\n+                : Player.State.IDLE;\r\n     }\r\n \r\n-    private void draw() {\r\n-        GraphicsContext g = getGraphicsContext2D();\r\n-        g.clearRect(0, 0, getWidth(), getHeight());\r\n+    private boolean collides(double px, double py) {\r\n \r\n-        drawMap(g);\r\n+        int gridX = (int) (px / tile);\r\n+        int gridY = (int) (py / tile);\r\n \r\n-        Image frame = player.update(1 / 60.0);\r\n-        g.drawImage(frame, player.x, player.y);\r\n+        if (map[gridY][gridX] == 1) return true; // unbreakable\r\n+        if (map[gridY][gridX] == 2) return true; // breakable\r\n+\r\n+        return false;\r\n     }\r\n \r\n-    private void drawMap(GraphicsContext g) {\r\n-        if (map == null) return;\r\n+    private void render() {\r\n+        GraphicsContext g = getGraphicsContext2D();\r\n \r\n+        g.clearRect(0, 0, getWidth(), getHeight());\r\n+        g.setImageSmoothing(false);\r\n+\r\n+        // Draw map\r\n         for (int y = 0; y < map.length; y++) {\r\n             for (int x = 0; x < map[0].length; x++) {\r\n \r\n-                int type = map[y][x];\r\n-                Image t = switch (type) {\r\n-                    case 1 -> tileUnbreak;\r\n-                    case 2 -> tileBreak;\r\n-                    default -> tileGround;\r\n-                };\r\n+                int t = map[y][x];\r\n \r\n-                g.drawImage(t,\r\n-                    x * tileSize,\r\n-                    y * tileSize,\r\n-                    tileSize,\r\n-                    tileSize\r\n-                );\r\n+                switch (t) {\r\n+                    case 0 -> g.drawImage(ground, x * tile, y * tile);\r\n+                    case 1 -> g.drawImage(unbreak, x * tile, y * tile);\r\n+                    case 2 -> g.drawImage(breakable, x * tile, y * tile);\r\n+                }\r\n             }\r\n         }\r\n+\r\n+        // Draw player\r\n+        g.drawImage(player.update(1 / 60.0), player.x, player.y);\r\n     }\r\n }\r\n"
                },
                {
                    "date": 1764401661982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n \r\n     private final int tile = 32;\r\n \r\n     public GameCanvas(Player player, InputHandler input) {\r\n-        super(800, 600);\r\n+        \r\n \r\n         this.player = player;\r\n         this.input = input;\r\n \r\n"
                },
                {
                    "date": 1764401670903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n \r\n     private final int tile = 32;\r\n \r\n     public GameCanvas(Player player, InputHandler input) {\r\n-        \r\n+        super(800, 600);\r\n \r\n         this.player = player;\r\n         this.input = input;\r\n \r\n"
                },
                {
                    "date": 1764401725065,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n \r\n     private final int tile = 32;\r\n \r\n     public GameCanvas(Player player, InputHandler input) {\r\n-        super(1280, 600);\r\n+        super(1920, 600);\r\n \r\n         this.player = player;\r\n         this.input = input;\r\n \r\n"
                },
                {
                    "date": 1764401731250,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,9 +22,9 @@\n \r\n     private final int tile = 32;\r\n \r\n     public GameCanvas(Player player, InputHandler input) {\r\n-        super(1920, 600);\r\n+        super(1920, 1080);\r\n \r\n         this.player = player;\r\n         this.input = input;\r\n \r\n"
                }
            ],
            "date": 1764385514385,
            "name": "Commit-0",
            "content": "package com.mygg.render;\r\n\r\nimport com.mygg.core.InputHandler;\r\nimport com.mygg.entities.Player;\r\n\r\nimport javafx.animation.AnimationTimer;\r\nimport javafx.scene.canvas.Canvas;\r\nimport javafx.scene.canvas.GraphicsContext;\r\nimport javafx.scene.image.Image;\r\n\r\npublic class GameCanvas extends Canvas {\r\n\r\n    private final Player player;\r\n    private final InputHandler input;\r\n    private long last = System.nanoTime();\r\n\r\n    public GameCanvas(Player player, InputHandler input) {\r\n        super(800, 600);\r\n        this.player = player;\r\n        this.input = input;\r\n\r\n        new AnimationTimer() {\r\n            @Override\r\n            public void handle(long now) {\r\n                double dt = (now - last) / 1e9;\r\n                last = now;\r\n\r\n                update(dt);\r\n                draw();\r\n            }\r\n        }.start();\r\n    }\r\n\r\n    private void update(double dt) {\r\n\r\n        boolean move = false;\r\n\r\n        if (input.up) {\r\n            player.y -= player.speed * dt;\r\n            player.dir = Player.Direction.UP;\r\n            move = true;\r\n        }\r\n        if (input.down) {\r\n            player.y += player.speed * dt;\r\n            player.dir = Player.Direction.DOWN;\r\n            move = true;\r\n        }\r\n        if (input.left) {\r\n            player.x -= player.speed * dt;\r\n            player.dir = Player.Direction.LEFT;\r\n            move = true;\r\n        }\r\n        if (input.right) {\r\n            player.x += player.speed * dt;\r\n            player.dir = Player.Direction.RIGHT;\r\n            move = true;\r\n        }\r\n\r\n        if (input.place) {\r\n            player.state = Player.State.PLACE;\r\n        } else {\r\n            player.state = move ? Player.State.WALK : Player.State.IDLE;\r\n        }\r\n    }\r\n\r\n    private void draw() {\r\n        GraphicsContext g = getGraphicsContext2D();\r\n\r\n        g.clearRect(0, 0, getWidth(), getHeight());\r\n\r\n        Image frame = player.update(1 / 60.0);\r\n\r\n        g.drawImage(frame, player.x, player.y);\r\n    }\r\n}\r\n"
        }
    ]
}